<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Remote Database usage system</title>
    <link href="file/css/bootstrap.min.css" rel="stylesheet">
    <link href="file/css/database.css" rel="stylesheet">
</head>
<body>
    <!-- navigation bar -->
    <nav class="navbar navbar-expand-md navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="/home">Remote Database usage system</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarid" aria-controls="navbarid" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarid">
                <ul class="navbar-nav me-auto mb-2 mb-md-0">
                    <li class="nav-item">
                        <a class="nav-link" aria-current="page"  href="/home">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/about">About</a>
                    </li>
                    {ifnot logged-in}
                    <li class="nav-item">
                        <a class="nav-link" href="/login">Sign-in</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/register">Reg-in</a>
                    </li>
                    {else logged-in}
                    <li class="nav-item">
                        <a class="nav-link" href="/logout">Sign-out</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link  active" href="/database">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-database" viewBox="0 0 16 16">
                                <path d="M4.318 2.687C5.234 2.271 6.536 2 8 2s2.766.27 3.682.687C12.644 3.125 13 3.627 13 4c0 .374-.356.875-1.318 1.313C10.766 5.729 9.464 6 8 6s-2.766-.27-3.682-.687C3.356 4.875 3 4.373 3 4c0-.374.356-.875 1.318-1.313ZM13 5.698V7c0 .374-.356.875-1.318 1.313C10.766 8.729 9.464 9 8 9s-2.766-.27-3.682-.687C3.356 7.875 3 7.373 3 7V5.698c.271.202.58.378.904.525C4.978 6.711 6.427 7 8 7s3.022-.289 4.096-.777A4.92 4.92 0 0 0 13 5.698ZM14 4c0-1.007-.875-1.755-1.904-2.223C11.022 1.289 9.573 1 8 1s-3.022.289-4.096.777C2.875 2.245 2 2.993 2 4v9c0 1.007.875 1.755 1.904 2.223C4.978 15.71 6.427 16 8 16s3.022-.289 4.096-.777C13.125 14.755 14 14.007 14 13V4Zm-1 4.698V10c0 .374-.356.875-1.318 1.313C10.766 11.729 9.464 12 8 12s-2.766-.27-3.682-.687C3.356 10.875 3 10.373 3 10V8.698c.271.202.58.378.904.525C4.978 9.71 6.427 10 8 10s3.022-.289 4.096-.777A4.92 4.92 0 0 0 13 8.698Zm0 3V13c0 .374-.356.875-1.318 1.313C10.766 14.729 9.464 15 8 15s-2.766-.27-3.682-.687C3.356 13.875 3 13.373 3 13v-1.302c.271.202.58.378.904.525C4.978 12.71 6.427 13 8 13s3.022-.289 4.096-.777c.324-.147.633-.323.904-.525Z"/>
                            </svg>
                            Database
                        </a>
                    </li>
                    {end logged-in}
                </ul>
            </div>
        </div>
    </nav>
    <!-- main -->
    <div class="container">
        <section>
            {if message}
            <p class="text-body-secondary">{messagetext}</p>
            {end message}
            <div class="row">
                <div class="col-md-4">
                    <form method="POST">
                        {if isadmin}
                        <h3>Connect:</h3>
                        <div class="form-floating">
                            <input type="text" class="form-control" id="floatingInput" placeholder="name" name="dbname" value="{namedb}">
                            <label for="floatingInput">database name</label>
                        </div>
                        <div class="form-floating">
                            <input type="text" class="form-control" id="floatingInput" placeholder="username" name="userName" value="{usernamedb}">
                            <label for="floatingInput">Username</label>
                        </div>
                        {end isadmin}
                        <div class="form-floating">
                            <input type="password" class="form-control" id="floatingInput" placeholder="password" name="password" value="{passworddb}">
                            <label for="floatingInput">Password</label>
                        </div>
                        <button class="w-100 btn btn-lg btn-primary" type="submit">GO</button>
                        <div class="form-floating">
                            <textarea type="text" class="form-control" id="sql" placeholder="SELECT * FROM table WHERE 1;" name="sqlRequest" value="{sqlreqdb}" cols="40" rows="3"></textarea>
                            <label for="floatingInput">Sql request</label>
                        </div>
                        {if sing-up_dataBase}
                        <h3>Tools:</h3>
                        <div class="form-floating">
                            <input type="text" class="form-control" id="floatingInput" placeholder="name table" name="doingtbname">
                            <label for="floatingInput">Name table</label>
                        </div>
                        <div class="form-floating">
                            <input type="text" class="form-control" id="floatingInput" placeholder="name pole" name="namepole">
                            <label for="floatingInput">Name column</label>
                        </div>
                        <select class="form-select" name="typepole">
                            <option value="text">text(TEXT)</option>
                            <option value="int">number(INT)</option>
                            <option value="date">date(DATE)</option>
                        </select>
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="flexCheckDefault" name="isPK" value="PRIMARY KEY">
                            <label for="flexCheckDefault">Primary key</label>
                        </div>
                        <button class="w-100 btn btn-lg btn-success" name="typedo" value="create">Create</button>
                        <button class="w-100 btn btn-lg btn-warning" name="typedo" value="drop">Drop</button>
                        {end sing-up_dataBase}
                    </form>
                </div>
                {if sing-up_dataBase}
                {if isadmin}
                <div class="col-md-4 text-center">
                    <table class="table table-striped table-hover caption-top" id="listdatabases">
                        <caption>Available databases</caption>
                        {loop listdb}
                        {loop listdb.column}
                        <tr onclick="onclick_to_row_list_databases();">
                            <td>{listdb.column.value}</td>
                        </tr>
                        {end listdb.column}
                        {end listdb}
                    </table>
                </div>
                {end isadmin}
                <div class="col-md-4 text-center">
                    <table class="table table-striped table-hover caption-top" id="listtables">
                        <caption>Available tables</caption>
                        {loop tables}
                        <tr id="{tables.idrow}" onclick="onclick_to_row_list_tables(event);">
                            <td name="table_name">{tables.table_name}</td>
                            <td name="column_name">{tables.column_name}</td>
                            <td name="data_type">{tables.data_type}</td>
                            <td name="is_nullable">{tables.is_nullable}</td>
                        </tr>
                        {end tables}
                    </table>
                </div>
                {end sing-up_dataBase}
            </div>
            {if response_not_null}
            <div class="row">
                <div class="col">
                    <h3>Response:</h3>
                    <table class="table table-striped">
                        {loop row}
                        <tr>
                            {loop row.column}
                            <td>{row.column.value}</td>
                            {end row.column}
                        </tr>
                        {end row}
                     </table>
                </div>
            </div>
            <p class="text-md-start"><a href="#">Export response to excel file</a></p>
            {end response_not_null}
        </section>
    </div>
    <!-- footer -->
    <nav class="navbar sticky-bottom navbar-expand-md">
        <div class="container-fluid">
            <footer class="d-flex justify-content-between align-items-center py-3 my-4 border-top">
                <div class="col-md-10 d-flex align-items-center">
                    <span class="text-body-secondary">© 2023 А.В. Лютов</span>
                </div>
                <ul class="nav col-md-2 justify-content-end list-unstyled d-flex">
                    <li class="ms-3">
                        <a class="text-body-secondary" href="https://github.com/MAYER-Ti/WebServer/tree/master">
                            <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-github" viewBox="0 0 16 16">
                                <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
                            </svg>
                        </a>
                    </li>
                </ul>
            </footer>
        </div>
    </nav>
    <script src="file/js/bootstrap.min.js"></script>
    <script src="file/js/database.js"></script>
</body>
</html>